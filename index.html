<!DOCTYPE html>
<html>
<body>

  <h1 align="center"> Sergejs Page </h1>

  <h1><ins>aqueue.py</ins></h1>
  
  <h3>
  
    &emsp;&emsp;<FONT color="red">import</FONT> threading<br>
    <p></p>
    &emsp;&emsp;<FONT color="red">class</FONT> <FONT color="orange">AQueue</FONT>(object):<br>
    &emsp;&emsp;&emsp;&emsp;"""Asynchronous Queue"""<br>
    &emsp;&emsp;&emsp;&emsp;<FONT color="red">def</FONT> <FONT color="purple">__init__</FONT>(self):<br>
        &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;self.lock&emsp;&emsp;&emsp;&emsp;&ensp;           <FONT color="blue">=</FONT> threading.<FONT color="orange">Lock</FONT>()<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;self.data_available <FONT color="blue">=</FONT> threading.<FONT color="orange">Condition</FONT>(self.lock)<br>
        &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;self.q&emsp;&emsp;&emsp;&emsp;&emsp;&ensp;&nbsp;              <FONT color="blue">=</FONT> []<br>
<p></p>
    &emsp;&emsp;&emsp;&emsp;<FONT color="red">def</FONT> <FONT color="purple">__str__</FONT>(self):<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<FONT color="red">with</FONT> self.lock:<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<FONT color="red">return</FONT> <FONT color="purple">str</FONT>(self.q)<br>
<p></p>
    &emsp;&emsp;&emsp;&emsp;<FONT color="red">def</FONT> <FONT color="purple">push</FONT>(self, x):<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<FONT color="red">with</FONT> self.lock:<br>
            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;self.q.<FONT color="purple">append</FONT>(x)<br>
            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;self.data_available.<FONT color="purple">notify</FONT>()<br>
<p></p>
    &emsp;&emsp;&emsp;&emsp;<FONT color="red">def</FONT> <FONT color="purple">pop</FONT>(self):<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<FONT color="red">with</FONT> self.lock:<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<FONT color="red">while</FONT> <FONT color="purple">len</FONT>(self.q) <FONT color="blue"><= 0</FONT>:<br>
                &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;self.data_available.<FONT color="purple">wait</FONT>()<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<FONT color="red">return</FONT> self.q.<FONT color="purple">pop</FONT>(<FONT color="blue">0</FONT>)<br>
<p></p>
    &emsp;&emsp;&emsp;&emsp;<FONT color="red">def</FONT> <FONT color="purple">iter</FONT>(self):<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<FONT color="red">while</FONT> <FONT color="blue">True</FONT>:<br>
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<FONT color="red">yield</FONT> self.<FONT color="purple">pop</FONT>()<br>
  
     
  </h1>

  <h1><p></p></h1>
    <h1><p></p></h1>  
    
  <h1><ins>channel.py</ins></h1>
    
   <h3>
    
     &emsp;&emsp;<FONT color="red">import</FONT> aqueue<br>
&emsp;&emsp;<FONT color="red">import</FONT> itertools<br>
<p></p>
     &emsp;&emsp;<FONT color="red">class</FONT> <FONT color="orange">Sender</FONT>(object):<br>
     &emsp;&emsp;&emsp;&emsp;<FONT color="red">def</FONT> <FONT color="purple">__init__</FONT>(self, aq):<br>
        &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;self.aq = aq<br>
<p></p>
    &emsp;&emsp;&emsp;&emsp;<FONT color="red">def</FONT> <FONT color="purple">send</FONT>(self, x):<br>
        &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;self.aq.<FONT color="purple">push</FONT>(x)<br>
<p></p>
    &emsp;&emsp;&emsp;&emsp;<FONT color="red">def</FONT> <FONT color="purple">copy</FONT>(self):<br>
        &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<FONT color="red">return</FONT> <FONT color="orange">Sender</FONT>(self.aq)<br>
<p></p>
&emsp;&emsp;<FONT color="red">class</FONT> <FONT color="orange">Receiver</FONT>(object):<br>
    &emsp;&emsp;&emsp;&emsp;<FONT color="red">def</FONT> <FONT color="purple">__init__</FONT>(self, aq):<br>
        &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;self.aq = aq<br>
<p></p>
    &emsp;&emsp;&emsp;&emsp;<FONT color="red">def</FONT> <FONT color="purple">recv</FONT>(self):<br>
        &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<FONT color="red">return</FONT> self.aq.<FONT color="purple">pop</FONT>()<br>
<p></p>
    &emsp;&emsp;&emsp;&emsp;<FONT color="red">def</FONT> <FONT color="purple">iter</FONT>(self):<br>
        &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<FONT color="red">return</FONT> self.aq.<FONT color="purple">iter</FONT>()<br>
<p></p>
&emsp;&emsp;<FONT color="red">def</FONT> <FONT color="purple">channel</FONT>():<br>
    &emsp;&emsp;&emsp;&emsp;aq = aqueue.<FONT color="orange">AQueue</FONT>()<br>
    &emsp;&emsp;&emsp;&emsp;<FONT color="red">return</FONT> (<FONT color="orange">Sender</FONT>(aq), <FONT color="orange">Receiver</FONT>(aq))<br>
<p></p>
&emsp;&emsp;<FONT color="red">def</FONT> <FONT color="purple">bichannel</FONT>():<br>
    &emsp;&emsp;&emsp;&emsp;(tx0, rx0) = <FONT color="purple">channel</FONT>()<br>
    &emsp;&emsp;&emsp;&emsp;(tx1, rx1) = <FONT color="purple">channel</FONT>()<br>
    &emsp;&emsp;&emsp;&emsp;<FONT color="red">return</FONT> ((tx0, rx1), (tx1, rx0))<br>
   
    </h3> 
    
    
  
  </body>
</html>
